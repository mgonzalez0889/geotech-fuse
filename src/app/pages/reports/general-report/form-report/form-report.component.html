<div class="flex flex-col w-full sm:pl-6">

  <div class="bg-card shadow rounded-2xl min-h-auto">

    <div class="w-full h-20 flex justify-between items-center px-2 pt-4 sm:px-12 border-b-2">
      <h2 class="text-2xl font-semibold tracking-tight leading-8">Generar Reporte</h2>
      <button mat-icon-button matTooltip="Cerrar" (click)="this.emitCloseForm.emit();">
        <mat-icon class="text-gray-400" [svgIcon]="'heroicons_outline:x'"></mat-icon>
      </button>
    </div>

    <div class="relative flex flex-col flex-auto items-center px-2 py-1 sm:px-12 sm:py-3">
      <div class="w-full max-w-3xl">
        <form [formGroup]="this.formReport" (ngSubmit)="onSubmit()" class="flex flex-col gap-3 mt-2">

          <mat-form-field class="fuse-mat-dense w-full">
            <mat-label>Seleccione el rango de fechas</mat-label>
            <mat-date-range-input [rangePicker]="picker">
              <input matStartDate placeholder="Desde" formControlName="date_init" />
              <input matEndDate placeholder="Hasta" formControlName="date_end" />
            </mat-date-range-input>

            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-date-range-picker #picker>
              <mat-date-range-picker-actions>
                <div class="flex flex-col gap-2">
                  <div class="flex justify-around">
                    <input type="time" matInput formControlName="timeInit">
                    <input type="time" matInput formControlName="timeEnd">
                  </div>
                  <div class="flex justify-end">
                    <button mat-button matDateRangePickerCancel>Cancel</button>
                    <button mat-raised-button color="accent" matDateRangePickerApply>Apply</button>
                  </div>
                </div>
              </mat-date-range-picker-actions>
            </mat-date-range-picker>
          </mat-form-field>

          <div class="flex gap-2 items-center">
            <mat-label class="mb-3">Buscar por:</mat-label>
            <mat-radio-group [(ngModel)]="selectTrasport" [ngModelOptions]="{standalone: true}" class="mb-3">
              <mat-radio-button class="mr-3" *ngFor="let trasport of listTrasport" (change)="onChangeTrasport($event)"
                [value]="trasport.name">{{ trasport.text }}</mat-radio-button>
            </mat-radio-group>
          </div>

          <div [hidden]="!(selectTrasport === 'mobiles')">
            <mat-form-field class="fuse-mat-dense w-full" appearance="fill">
              <mat-select multiple formControlName="plates" placeholder="Seleccione vehiculos">
                <mat-option class="option-all" #allSelectedMobiles (click)="this.allSelectionMobiles()" [value]="0">
                  Seleccionar todos
                </mat-option>
                <mat-option [value]="mobile.plate" *ngFor="let mobile of this.plates">
                  {{ mobile.plate }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div [hidden]="!(selectTrasport === 'fleet')">
            <mat-form-field class="fuse-mat-dense w-full" appearance="fill">
              <mat-select multiple formControlName="fleets" placeholder="Seleccione flotas">
                <mat-option class="option-all" #allSelectedFleets (click)="this.allSelectionFleets()" [value]="0">
                  Seleccionar todos
                </mat-option>
                <mat-option [value]="fleet.id" *ngFor="let fleet of this.fleets">
                  {{ fleet.name }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="mt-3">
            <mat-form-field class="fuse-mat-dense w-full" appearance="fill">
              <mat-select multiple formControlName="events" placeholder="Seleccione eventos">

                <div class="option-all ">
                  <div class="flex items-center gap-2 px-4 py-2">
                    <mat-icon class="icon-size-5 " svgIcon="heroicons_solid:search">
                    </mat-icon>
                    <input class="w-full min-w-0 py-1 border-0" type="text" [(ngModel)]="valueFilterEvents"
                      [ngModelOptions]="{standalone: true}" placeholder="Buscar" [maxLength]="30">
                  </div>
                  <mat-option #allSelectedEvents (click)="this.allSelectionEvents()" [value]="0">
                    Seleccionar todos
                  </mat-option>
                </div>

                <mat-option [value]="event.event_id"
                  *ngFor="let event of this.events | filterList:valueFilterEvents:'event_name'">
                  {{ event.event_name }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>


          <div
            class="flex flex-row items-center justify-end sm:justify-end px-6 py-4 space-x-3 dark:bg-black dark:bg-opacity-10 w-full">
            <button class="ml-auto" mat-button matTooltip="Cancelar" (click)="this.emitCloseForm.emit();">
              Cancelar
            </button>

            <button class="ml-2" type="submit" mat-flat-button color="accent" [disabled]="this.formReport.invalid"
              [matTooltip]="'Guardar'">
              Generar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>