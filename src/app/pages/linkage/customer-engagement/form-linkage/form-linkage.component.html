<div class="flex flex-col w-full sm:pl-6">
  <div class="bg-card shadow rounded-2xl min-h-auto">

    <div class="rounded-t-2xl relative w-full h-40 sm:h-48 px-8 sm:px-12 bg-gray-200">
      <div class="flex items-center justify-end w-full max-w-3xl mx-auto pt-6">
        <button mat-icon-button matTooltip="Cerrar" (click)="this.closeForm()">
          <mat-icon class="text-gray-400" svgIcon="heroicons_outline:x"></mat-icon>
        </button>
      </div>
    </div>

    <div class="relative flex flex-col flex-auto items-center p-6 pt-0 sm:p-12 sm:pt-0">
      <div [hidden]="editMode" class="w-full max-w-3xl">


        <div class="flex flex-auto items-end -mt-16">
          <!-- Avatar -->
          <div class="flex items-center justify-center w-32 h-32 rounded-full overflow-hidden ring-4 ring-bg-card">
            <div
              class="flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200">
              <span *ngIf="dataUpdate">{{this.titleForm?.charAt(0)}} </span>
              <mat-icon *ngIf="!dataUpdate" class="icon-size-14"
                [svgIcon]="'heroicons_solid:clipboard-check'"></mat-icon>
            </div>
          </div>
          <!-- Actions -->
          <div *ngIf="this.dataUpdate" class="flex items-center ml-auto mb-1">
            <button mat-stroked-button (click)="openEdit()">
              <mat-icon *ngIf="this.dataUpdate" class="icon-size-5"
                [svgIcon]="'heroicons_outline:pencil-alt'"></mat-icon>
              <span class="ml-2">Iniciar proceso</span>
            </button>
          </div>
        </div>

        <div class="mt-3 text-3xl font-bold flex flex-row">{{this.titleForm}}</div>

        <div *ngIf="this.titleForm==='Buscar cliente'">

          <div class="flex flex-col  p-1 w-full">
            <div class="flex border-2 rounded-full p-2 ">

              <form [formGroup]="this.formSearchClient" class="w-full flex">
                <input type="text" formControlName="search" autocomplete="off" matInput [matAutocomplete]="auto"
                  placeholder="Buscar" (keyup)="search()">
                <mat-icon class="icon-size-5" matSuffix svgIcon="heroicons_outline:search"></mat-icon>

                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete"
                  (optionSelected)="selectedOption( $event )">

                  <mat-option class="text-md" *ngFor="let data of dataSearchClient;" [value]="data">
                    {{ data.name + ' Nit : ' + data.nit }}
                  </mat-option>
                </mat-autocomplete>

              </form>


            </div>
            <label class="text-md mt-2" *ngIf="showError && this.formSearchClient.valid">
              <span class="text-red-600">No se encontró ningun cliente : {{ this.valueSearch }}</span>
            </label>
          </div>



        </div>

        <div class="flex flex-col mt-4 pt-6 border-t space-y-8" *ngIf="this.dataUpdate">
          <div class="flex sm:items-center">
            <mat-icon matTooltip="Nombre usuario" svgIcon="heroicons_solid:user-circle">
            </mat-icon>
            <div class="ml-6 leading-6 flex flex-row">{{dataUpdate['name']}}</div>
          </div>
          <div class="flex sm:items-center"  >
            <mat-icon matTooltip="Correo electrónico" svgIcon="heroicons_outline:mail">
            </mat-icon>
            <div class="ml-6 leading-6">
              <a class="hover:underline text-primary-500" [href]="'mailto:' + dataUpdate['email']" target="_blank">
                {{dataUpdate['email']}}
              </a>
            </div>
          </div>
          <div class="flex sm:items-center" >
            <mat-icon matTooltip="Celular" svgIcon="heroicons_outline:phone"></mat-icon>
            <div class="ml-6 leading-6">{{dataUpdate['phone']}}</div>
          </div>
          <div class="flex sm:items-center">
            <mat-icon matTooltip="Estado" svgIcon="heroicons_outline:information-circle">
            </mat-icon>
            <div class="ml-6 leading-6">{{dataUpdate['state']}}</div>
          </div>

        </div>
      </div>




      <div class="w-full" [hidden]="!editMode">
        <form [formGroup]="this.formUserClient" autocomplete="off" class="flex flex-col gap-3 pt-6">

          <mat-form-field class="w-full fuse-mat-dense">
            <mat-label>Nombre completo</mat-label>
            <mat-icon matPrefix class="hidden sm:flex icon-size-5" svgIcon="heroicons_outline:user-circle"></mat-icon>
            <input readonly type="text" matInput [placeholder]="'this.clientSelected[nomcli]'" formControlName="name">
          </mat-form-field>

          <mat-form-field class="w-full fuse-mat-dense">
            <mat-label>Telefono</mat-label>
            <mat-icon matPrefix class="hidden sm:flex icon-size-5" svgIcon="heroicons_outline:phone"></mat-icon>
            <input readonly type="text" matInput placeholder="" formControlName="phone">
          </mat-form-field>

          <mat-form-field class="w-full fuse-mat-dense">
            <mat-label>Correo</mat-label>
            <mat-icon matPrefix class="hidden sm:flex icon-size-5" svgIcon="heroicons_outline:mail"></mat-icon>
            <input type="mail" matInput placeholder="" formControlName="email">
          </mat-form-field>

            <mat-form-field class="w-full fuse-mat-dense" *ngIf="this.clientSelected['company'] ==='NIT'">
              <mat-label>Representante Legal</mat-label>
              <mat-icon matPrefix class="hidden sm:flex icon-size-5" svgIcon="heroicons_outline:user"></mat-icon>
              <input  type="text" matInput placeholder="" formControlName="legal_representative" >
            </mat-form-field>
  
            <mat-form-field class="w-full fuse-mat-dense" *ngIf="this.clientSelected['company'] ==='NIT'">
              <mat-label>Numero de documento</mat-label>
              <mat-icon matPrefix class="hidden sm:flex icon-size-5" svgIcon="heroicons_outline:identification"></mat-icon>
              <input  type="number" matInput placeholder="" formControlName="document_number" >
            </mat-form-field>
  

          <mat-form-field class="w-full fuse-mat-dense">
            <mat-label>Fecha expedición documento</mat-label>
            <mat-datepicker-toggle class="-ml-2.5" matIconSuffix  [for]="picker"></mat-datepicker-toggle>
            <input formControlName="date_issued" class="ml-2" matInput [matDatepicker]="picker" required>

            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>










          <div [hidden]="!editMode" class="flex items-center mt-4 -mx-6 sm:-mx-12  pr-4 pl-1 sm:pr-12 sm:pl-7">
            <button *ngIf="!clientSelected" type="button" mat-button color="warn" matTooltip="Eliminar">
              Eliminar
            </button>

            <button type="button" class="ml-auto" mat-button matTooltip="Cancelar" (click)="this.editMode = false">
              Cancelar
            </button>

            <button *ngIf="this.sendEmail===false" class="ml-2" type="button" mat-flat-button color="accent" [disabled]="this.formUserClient.invalid"
              matTooltip="Guardar" (click)="onSave()">
              Guardar
            </button>

            <button *ngIf="this.sendEmail===true" class="ml-2" type="button" mat-flat-button color="accent" [disabled]="this.formUserClient.invalid"
              matTooltip="Enviar" (click)="sendEmailServices()">
              Enviar solicitud
            </button>

          </div>
        </form>





      </div>






    </div>
  </div>
</div>